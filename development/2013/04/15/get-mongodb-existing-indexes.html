<!DOCTYPE html>
<html class="nojs">
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Get MongoDB existing indexes * ixti's personal scratchpad</title>
    <meta name="description" content="Personal blog of Aleksey V Zapparov AKA ixti">
    <meta name="viewport" content="width=device-width">
    <meta name="generator" content="jekyll">
    <link rel="stylesheet" type="text/css" href="http://fonts.googleapis.com/css?family=Open+Sans+Condensed:300:latin,cyrillic|Open+Sans::latin">
    <link rel="stylesheet" href="/assets/app-7ec9dff94a465c2ed5d6865f8d106d58.css">
    <script src="/assets/app-a5eac6a6dcd80a63d9a7222d0d345b93.js"></script>
  </head>
  <body class="light">
    <header id="header">
      <h1><a href="/"><span>personal scratchpad</span></a></h1>
      <div id="top-navigation" class="navbar">
        <ul>
          <li><a href="https://github.com/ixti/ixti.github.com">Sources</a></li>
          <li id="js-theme-switcher"><a href="#">Switch Theme</a></li>
        </ul>
        <ul>
          <li><a href="https://github.com/ixti">GitHub</a></li>
          <li><a href="http://es.linkedin.com/in/zapparov">LinkedIn</a></li>
          <li><a href="https://twitter.com/zapparov">Twitter</a></li>
          <li><a href="http://feeds.feedburner.com/ixti">RSS</a></li>
        </ul>
      </div>
    </header>

    <article class="post">
  <header>
    <h2>Get MongoDB existing indexes</h2>
    
    <ul class="post-info">
  <li>Date: 15 Apr 2013</li>

  
    <li>Category: <a href="/categories/development.html">development</a></li>
  

  
    <li>Tagged with: <a href="/tags/snippet.html">snippet</a>, <a href="/tags/mongodb.html">mongodb</a>, <a href="/tags/index.html">index</a>, and <a href="/tags/javascript.html">javascript</a></li>
  
</ul>

  </header>

  <p>When your application on an early development stage, your indexes are changing
very fast. And most of the time you only add more and more indexes, until you
come to the point that either MongoDB fails auto-guessing a proper index to use
or indexes are taking too much RAM. This is a simple snippet that allows get a
list of existing indexes (except built-in) of all collections in your MongoDB&hellip;</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">db</span><span class="p">.</span><span class="nx">getCollectionNames</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">coll</span><span class="p">)</span> <span class="p">{</span>
  <span class="nx">db</span><span class="p">[</span><span class="nx">coll</span><span class="p">].</span><span class="nx">getIndexes</span><span class="p">().</span><span class="nx">forEach</span><span class="p">(</span><span class="kd">function</span><span class="p">(</span><span class="nx">index</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="s2">&quot;_id_&quot;</span> <span class="o">!==</span> <span class="nx">index</span><span class="p">.</span><span class="nx">name</span><span class="p">)</span> <span class="p">{</span>
      <span class="nx">print</span><span class="p">(</span><span class="s2">&quot;db.&quot;</span> <span class="o">+</span> <span class="nx">coll</span> <span class="o">+</span> <span class="s2">&quot;.ensureIndex(&quot;</span> <span class="o">+</span> <span class="nx">tojson</span><span class="p">(</span><span class="nx">index</span><span class="p">.</span><span class="nx">key</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span><span class="p">);</span>
    <span class="p">}</span>
  <span class="p">});</span>
<span class="p">});</span>
</code></pre></div>
<p>You can either run this script inside mongo shell, or save this into
<code>show-indexes.js</code> file and execute it as follows:</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">$ cat show-indexes.js | mongo --quiet my-database
</code></pre></div>
</article>



<!-- DISQUS -->
<div id="disqus_thread"></div>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>


    <ul id="bottom-navigation" class="navbar">
      
        <li><a href="/archives/2014.html">2014</a></li>
      
        <li><a href="/archives/2013.html">2013</a></li>
      
        <li><a href="/archives/2012.html">2012</a></li>
      
        <li><a href="/archives/2011.html">2011</a></li>
      
        <li><a href="/archives/2010.html">2010</a></li>
      
    </ul>

    <footer id="footer" role="contentinfo">
      kindly generated by <a href="https://github.com/mojombo/jekyll">Jekyll</a>
      ~
      crafted by <a href="http://ixti.net">ixti</a>
      using <a href="http://gimp.org/">Gimp</a>
      and <a href="http://www.vim.org/">Vim</a>
      ~
      copyright &copy; 2010 Aleksey V Zapparov AKA ixti
    </footer>
  </body>
</html>
